<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yeni SipariÅŸ - WebCreate</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@400;700&family=Lora:ital@1&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style>
        #live-preview { transition: all 0.5s ease-in-out; }
        .color-picker-wrapper { display: flex; align-items: center; gap: 10px; }
        .color-picker-wrapper input[type="color"] { border: none; width: 40px; height: 40px; border-radius: 5px; cursor: pointer; }
        #preview-logo { max-width: 150px; max-height: 50px; object-fit: contain; }
    </style>
</head>
<body>
    <%- include('../partials/user-header') %>

    <main class="container" style="min-height: 80vh; padding: 2rem 0;">
        <div class="animate-fade-in">
            <div style="text-align: center; margin-bottom: 2rem;">
                <h1 style="color: var(--white);">Yeni Web Sitesi SipariÅŸi</h1>
                <p style="color: #ccc;">Sitenizi canlÄ± olarak tasarlayÄ±n ve sipariÅŸinizi oluÅŸturun</p>
            </div>

            <form action="/orders/create" method="POST" enctype="multipart/form-data" data-validate>
                <div class="row" style="align-items: flex-start; gap: 2rem;">
                    
                    <div class="col" style="flex: 2;">
                        <div class="card">
                            <h3 style="color: var(--white);">1. Temel Bilgiler</h3>
                            <div class="form-group">
                                <label for="title" class="form-label">Site BaÅŸlÄ±ÄŸÄ± / Marka AdÄ±</label>
                                <input type="text" id="title" name="title" class="form-control" required placeholder="Ã–rn: Enes OcakÃ§Ä± Photography">
                            </div>
                            <div class="form-group">
                                <label for="description" class="form-label">Site HakkÄ±nda (Anasayfa Ä°Ã§eriÄŸi)</label>
                                <textarea id="description" name="description" class="form-control" required placeholder="Sitenizin anasayfasÄ±nda yer alacak ana metin..." rows="6"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="logo" class="form-label">Logo YÃ¼kle</label>
                                <input type="file" id="logo" name="logo" class="form-control" accept="image/*">
                            </div>
                        </div>

                        <div class="card">
                            <h3 style="color: var(--white);">2. TasarÄ±m & Stil</h3>
                             <div class="form-group">
                                <label for="layout" class="form-label">Tema Stili</label>
                                <select id="layout" name="designDetails[layout]" class="form-control">
                                    <option value="modern">Modern & Temiz</option>
                                    <option value="corporate">Kurumsal & Profesyonel</option>
                                    <option value="dark-elegant">Koyu & Zarif</option>
                                    <option value="vibrant">CanlÄ± & YaratÄ±cÄ±</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="font" class="form-label">YazÄ± Tipi</label>
                                <select id="font" name="designDetails[font]" class="form-control">
                                    <option value="Roboto">Roboto (Modern)</option>
                                    <option value="Lora">Lora (Serif, Klasik)</option>
                                    <option value="Playfair Display">Playfair Display (Zarif)</option>
                                    <option value="Inter">Inter (OkunaklÄ±)</option>
                                </select>
                            </div>
                             <div class="form-group">
                                <label class="form-label">Renk Paleti</label>
                                <div class="color-picker-wrapper">
                                    <label for="primaryColor">Ana Renk:</label>
                                    <input type="color" id="primaryColor" name="designDetails[primaryColor]" value="#007bff">
                                    <label for="secondaryColor">Arkaplan Rengi:</label>
                                    <input type="color" id="secondaryColor" name="designDetails[secondaryColor]" value="#ffffff">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col" style="flex: 1; position: sticky; top: 2rem;">
                        <div class="card">
                            <h3 style="color: var(--white);">CanlÄ± Ã–nizleme</h3>
                            <div id="live-preview" style="border: 1px solid var(--light-gray); border-radius: 8px; min-height: 450px; overflow: hidden;">
                                <header id="preview-header" style="padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;">
                                    <img id="preview-logo" src="" alt="logo" style="display: none;">
                                    <h4 id="preview-title" style="font-size: 1.5em; margin: 0;">Site BaÅŸlÄ±ÄŸÄ±</h4>
                                    <nav> <a href="#" class="preview-link">MenÃ¼</a> </nav>
                                </header>
                                <section id="preview-content" style="padding: 30px 20px;">
                                    <h1 id="preview-main-heading" style="font-size: 2em; margin-bottom: 15px;">Ana BaÅŸlÄ±k</h1>
                                    <p id="preview-description" style="font-size: 1em; line-height: 1.6;">...</p>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 2rem;">
                    <button type="submit" class="btn hover-lift" style="font-size: 1.2rem; padding: 0.8rem 2rem;">ðŸš€ SipariÅŸi OluÅŸtur</button>
                </div>
            </form>
        </div>
    </main>

    <%- include('../partials/footer') %>
    <script src="/js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Form elemanlarÄ±
            const titleInput = document.getElementById('title');
            const descriptionInput = document.getElementById('description');
            const layoutSelect = document.getElementById('layout');
            const fontSelect = document.getElementById('font');
            const primaryColorPicker = document.getElementById('primaryColor');
            const secondaryColorPicker = document.getElementById('secondaryColor');
            const logoInput = document.getElementById('logo');

            // Ã–nizleme elemanlarÄ±
            const preview = document.getElementById('live-preview');
            const previewHeader = document.getElementById('preview-header');
            const previewTitle = document.getElementById('preview-title');
            const previewLogo = document.getElementById('preview-logo');
            const previewContent = document.getElementById('preview-content');
            const previewMainHeading = document.getElementById('preview-main-heading');
            const previewDescription = document.getElementById('preview-description');
            const previewLink = document.querySelector('.preview-link');

            function updatePreview() {
                // Metinleri gÃ¼ncelle
                const siteTitle = titleInput.value || 'Site BaÅŸlÄ±ÄŸÄ±';
                previewTitle.textContent = siteTitle;
                previewMainHeading.textContent = siteTitle;
                previewDescription.textContent = descriptionInput.value || 'Sitenizin ana sayfasÄ±nda yer alacak ilgi Ã§ekici iÃ§erik burada olacak.';

                // Renkleri gÃ¼ncelle
                const primaryColor = primaryColorPicker.value;
                const secondaryColor = secondaryColorPicker.value;
                const isDark = isColorDark(secondaryColor);
                const textColor = isDark ? '#ffffff' : '#333333';

                preview.style.backgroundColor = secondaryColor;
                previewHeader.style.borderBottom = `1px solid ${isDark ? '#555' : '#eee'}`;
                [previewTitle, previewMainHeading, previewDescription, previewLink].forEach(el => el.style.color = textColor);
                previewTitle.style.color = primaryColor;
                previewLink.style.borderColor = primaryColor;


                // Fontu gÃ¼ncelle
                const selectedFont = fontSelect.value;
                preview.style.fontFamily = `'${selectedFont}', sans-serif`;

                // Tema/Layout GÃ¼ncelle
                switch(layoutSelect.value) {
                    case 'corporate':
                        previewHeader.style.justifyContent = 'flex-start';
                        previewTitle.style.fontSize = '1.3em';
                        break;
                    case 'dark-elegant':
                        if(secondaryColorPicker.value === '#ffffff') secondaryColorPicker.value = '#1a1a1a';
                        if(primaryColorPicker.value === '#007bff') primaryColorPicker.value = '#f1c40f';
                        break;
                    case 'vibrant':
                         if(primaryColorPicker.value === '#007bff') primaryColorPicker.value = '#e74c3c';
                        break;
                    case 'modern':
                    default:
                        previewHeader.style.justifyContent = 'space-between';
                        previewTitle.style.fontSize = '1.5em';
                        break;
                }
            }
            
            // Logo YÃ¼kleme
            logoInput.addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        previewLogo.src = event.target.result;
                        previewLogo.style.display = 'block';
                        previewTitle.style.display = 'none'; // Logo varken baÅŸlÄ±ÄŸÄ± gizle
                    }
                    reader.readAsDataURL(e.target.files[0]);
                }
            });

            // Renk parlaklÄ±ÄŸÄ±nÄ± kontrol et
            function isColorDark(hexcolor){
                const r = parseInt(hexcolor.substr(1, 2), 16);
                const g = parseInt(hexcolor.substr(3, 2), 16);
                const b = parseInt(hexcolor.substr(5, 2), 16);
                const yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;
                return yiq < 128;
            }

            // TÃ¼m inputlara event listener ekle
            [titleInput, descriptionInput, layoutSelect, fontSelect, primaryColorPicker, secondaryColorPicker].forEach(el => {
                el.addEventListener('input', updatePreview);
                el.addEventListener('change', updatePreview);
            });

            // Ä°lk yÃ¼klemede Ã§alÄ±ÅŸtÄ±r
            updatePreview();
        });
    </script>
</body>
</html>